# Final_Project
big data final project   : " Music_Origin_Prediction "
רקע כללי:

מידע על מערך נתונים: 
 
מערך הנתונים נבנה מאוסף אישי של 1059 מסלולים המכסים 33 מדינות/אזור. המוזיקה שבה נעשה שימוש היא מסורתית, אתנית או 'עולמית' בלבד, לפי סיווג המוציאים לאור של המוצר שעליו היא מופיעה. כל מוזיקה מערבית אינה נכללת מכיוון שהשפעתה גלובלית - מה שאנו מחפשים הם ההיבטים של המוזיקה שהכי משפיעים על המיקום. לפיכך, היכולת לציין מיקום עם השפעה חזקה על המוזיקה היא מרכזית.

המיקום הגיאוגרפי של המקור נאסף באופן ידני את המידע מתוך הערות בשרוול התקליטור, וכאשר מידע זה לא היה מספק, חיפשנו מקורות מידע אחרים. נתוני המיקום מוגבלים בדייקנות לארץ המוצא.

ארץ המוצא נקבעה לפי ארץ/אזור המגורים העיקריים של האמן או האמנים. כל רצועה שמקורה היה מעורפל אינו כלול. לקחנו את עמדת עיר הבירה של כל מדינה (או מחוז האזור) לפי קווי רוחב ואורך כנקודת המוצא המוחלטת.

התוכנית MARSYAS[1] שימשה לחילוץ תכונות אודיו מקבצי ה-wave. השתמשו בהגדרות ברירת המחדל של MARSYAS בפורמט וקטור יחיד (68 תכונות) כדי להעריך את הביצועים עם מידע טימבלי בסיסי המכסה את כל האורך של כל רצועה. לא הוחל שקלול תכונה או סינון מקדים. כל התכונות שונו לממוצע של 0, וסטיית תקן של 1. חקרו גם את התועלת של הוספת תכונות כרומטיות. אלה מתארים את התווים של הסולם בשימוש. זה חשוב במיוחד כמאפיין מבחין באתנומוזיקולוגיה גיאוגרפית. המאפיינים הכרומטיים שמספק MARSYAS הם 12 לאוקטבה - כוונון מערבי, אבל אולי אפשר להבחין במשהו מכמה המוזיקה דומה או שונה מכוונון מערבי.

[1] G. Tzanetakis and P. Cook, "MARSYAS: a framework for analysis audio," Organized Sound, vol. 4, עמ' 169-175, 2000.


מידע על תכונות:
מערך הנתונים קיים בשני קבצים, כאשר כל קובץ מתאים לקבוצות תכונות שונות.
שני הקבצים מכילים את תכונות האודיו של 1059 רצועות.

•	בקובץ 'default_features_1059_tracks.txt', 68
 העמודות הראשונות הן תכונות אודיו של הרצועה, ושתי העמודות האחרונות הן מקור המוזיקה, המיוצגות על ידי קווי רוחב ואורך.

•	בקובץ 'default_plus_chromatic_features_1059_tracks.txt', 116 העמודות הראשונות הן תכונות אודיו של הרצועה, ושתי העמודות האחרונות הן מקור המוזיקה.



שאלה  שרוצים לחקור :

- מה המקור הגיאוגרפי של המוזיקה ?


תיאור אלגוריתם החיזוי (שיטות):
תיאור :
•	קודם כל השתמשנו רק בקובץ 'default_features_1059_tracks.txt', 68  
(העמודות הראשונות הן תכונות אודיו של הרצועה, ושתי העמודות האחרונות הן מקור המוזיקה, המיוצגות על ידי קווי רוחב ואורך)

•	הנתונים מורכבים מ-1059 שירים שלכל אחד מהם 68 תכונות אודיו. לכל שיר מקור גיאוגרפי בצורת קואורדינטות קווי רוחב ואורך.
 ישנן 33 ערכות קואורדינטות ייחודיות המייצגות את 33 בירות של 33 מדינות שונות , שמעיד עך כך שהפרויקט הזה מתעסק בבעיית סיווג .

1-	אנחנו רוצים לסווג כל שיר לפי מיקום גיאוגרפי .
2-	אנו משתמשים ב-PCA כדי לקבוע אם נוכל לצמצם את מספר התכונות המשמשות במודל שלנו.
3-	השתמשנו במודל random forest 
(יערות אקראיים או יערות החלטה אקראיים) כיוון שהיא שיטת לימוד אנסמבל לסיווג .

4-	 נמצא את כל התכונות הרלוונטיות שהמודל random forest
משתמש בהם , ונמחק כל תכונה שהיא לא רלוונטית ( שהאלגוריתם לא משמש בה ) .

5- נריץ את המודל מחדש עם התכונות הרלוונטיות ונבדוק את מידת הדיוק על קבוצת האימות (validate) .
(בעצם כדי לראות אם ציוני הדיוק עולים )

ספריות שהשתמשנו בהם :
1-	matplotlib.pyplot 
2-	matplotlib.cm 
3-	pandas
4-	sklearn.cluster.KMeans
5-	sklearn.model_selection.train_test_split
6-	sklearn.preprocessing.StandardScaler
7-	sklearn.decomposition.PCA
8-	sklearn.metrics
9-	sklearn.ensemble.RandomForestClassifier
10-	sklearn.feature_selection.SelectFromModel


•	טבלת הנתונים נשמרה כקובץ חיצוני בשם " data_table.csv"

•	לצורך הבנת הפרויקט יצרנו טבלה שבה לכל קוו רוחב וקוו אורך את המדינה שאליה הם שייכים וגם את מספר השירים ששייכים למדינה עצמה .

	latitude	longitude	Count	Countries
0	-35.3	149.12	14	Australia
1	-15.75	-47.95	36	Brazil
2	-6.17	35.74	20	Tanzania
3	-6.17	106.82	25	Indonesia
4	-1.26	36.8	32	Kenya
5	9.03	38.74	30	Ethiopia
6	11.55	104.91	14	Cambodia
7	12.65	-8	66	Mali
8	13.75	100.48	27	Thailand
9	14.66	-17.41	24	Senegal
10	14.91	-23.51	34	Cape Verde
11	17.25	-88.76	11	Belize
12	17.98	-76.8	22	Jamaica
13	19.75	96.1	25	Myanmar
14	23.76	121	25	Taiwan
15	28.61	77.2	69	India
16	30.03	31.21	31	Egypt
17	33.66	73.16	47	Pakistan
18	34.03	-6.85	33	Morocco
19	35.68	51.41	23	Iran
20	35.7	139.71	19	Japan
21	36.7	3.21	35	Algeria
22	38	23.71	46	Greece
23	39.91	32.83	64	Turkey
24	39.91	116.38	40	China
25	41.26	69.21	36	Uzbekistan
26	41.33	19.8	21	Albania
27	41.71	44.78	29	Georgia
28	41.9	12.48	51	Italy
29	42.86	74.6	26	Kyrgyzstan
30	44.41	26.1	19	Romania
31	52.5	-0.12	33	United Kingdom
32	54.68	25.31	32	Lithuania



תוצאות :

•	נצייר את הקשר הראשוני בין קו אורך וקווי רוחב :

 

•	מערך הנתונים מורכב מתכונות שמע שחולצו באמצעות MARSYAS. ניתן לראות את התכונות בהן אנו משתמשים כתכונות האודיו העיקריות של שיר. אנחנו צריכים לחזות את האזור הגיאוגרפי של שיר על סמך התכונות האלה. 
הנתונים במערך הנתונים אינם כוללים אזורים גיאוגרפיים, אלא קואורדינטות של רוחב ואורך. 
אנו יכולים לדמיין את האזורים הללו באמצעות אשכולות.
ונקבל לפי אלגוריתם KMeans  את 33 הצנטרואידים של
 33 המדינות :

 

	0	1
0	30.03	31.21
1	12.65	-8
2	13.75	100.48
3	17.25	-88.76
4	33.66	73.16
5	36.7	3.21
6	-1.26	36.8
7	23.76	121
8	-15.75	-47.95
9	-35.3	149.12
10	41.33	19.8
11	35.68	51.41
12	14.91	-23.51
13	39.91	116.38
14	-6.17	106.82
15	35.7	139.71
16	52.5	-0.12
17	39.91	32.83
18	54.68	25.31
19	41.26	69.21
20	9.03	38.74
21	17.98	-76.8
22	34.03	-6.85
23	41.9	12.48
24	19.75	96.1
25	28.61	77.2
26	41.71	44.78
27	44.41	26.1
28	38	23.71
29	14.66	-17.41
30	42.86	74.6
31	-6.17	35.74
32	11.55	104.91





		
 

•	אנו יודעים מעט על המשמעות של תכונות האודיו השונות. 
נשתמש ב- PCA כדי לשרטט את השונות. מימד PCA (PC) אינו שווה ערך לתכונה, אך נוכל לדעת באופן מספיק אם יש תכונות שאינן תורמות לשונות במרחב התכונה .

 

בהסתכלות על הגרף לעיל, נראה כאילו יש אפשרות להפחית את הממדיות של מרחב התכונות מבלי לאבד הרבה שונות .

•	בהרצת אלגוריתם  random forestלפעם הראשונה נקבל ציון דיוק 
Random Forest accuracy:0.42138364779874216

(ברוב ההרצות בין 0.40 ל 0.50 ) שזה מאוד טוב מכיוון שיש לנו 33 אשכולות אז באופן טבעי לסווג דוגמת אימון לאשכול מסוים ה קורה ב0.333 אחוז , אז הדיוק של אלגוריתם  random forestיותר גבוהה מזה מה שמעיד על סיווג מוצלח .

•	אחרי שחקרנו את אלגוריתם  random forest מצאנו שיש 28 תכונות רלוונטיות שהן העמודות 
[ 2,  4,  6,  7,  8,  9, 11, 15, 18, 20, 22, 23, 24, 30, 34, 35, 36,  37, 41, 42, 51, 52, 53, 54, 55, 59, 60, 62]

•	אז בנינו מערך נתונים חדש עם התכונות הרלוונטיות , טבלת הנתונים נשמרה כקובץ חיצוני בשם " relevant_features.csv"

•	אז עכשיו נחזור על אותו תהליך ונריץ אלגוריתם  random forestעל קבוצת האימות ונבדוק את ציון הדיוק
Random Forest accuracy:0.46308724832214765

( בכל ההרצות ציון הדיוק היה גם בין 0.40 ל 0.50 ) וכמעט בכל ההרצות ראינו שציון הדיוק עלה מה שמעיד על כך שהסרת התכונות הלא רלוונטיות השפיעה על פעולת האלגוריתם ושיפרה 
את התוצאה .


דיון :  

לפי התוצאות נקבל שהאלגוריתם כן מחלק את השירים לפי אזורים , כלומר לכל שיר הוא מסווג אותו לאשכול שמעיד על מקורו הגיאוגרפי .
 לעומת שקיבלנו ציוני דיוק יחסית הגיוניים וטובים ביחס למספר האשכולות שיש לנו אבל ראינו שבאמת קשה לסווג שירים לפי מיקום גיאוגרפי. 
אולי היה כדאי להפחית מספר האשכולות הגיאוגרפיים, ואז לסווג שירים לפי יבשות ולא דווקא מדינות .
זאת ועוד שבמציאות, מדובר בתערובת של למידה מפוקחת ובלתי מפוקחת. בחירת תכונות הופכת אותה למשימה תובענית עוד יותר.
בנוסף, אין לנו מידע רב על התכונות המשמשות במודל זה, אבל יהיה הוגן לשאול האם התכונות שאנו משתמשים בהן מסבירות מספיק את השונות במאפייני השיר.
יכול להיות שמאפיינים אלה אינם תופסים את ההבדלים המוזיקליים המהותיים בין האזורים.
ואולי יהיה יותר שווה לחקור מאפיינים שונים של גלי קול שלא נכללו במערך נתונים ובכך זה עלול לגרום לציוני דיוק גבוהים יותר. 

המשך לפרויקט לעתיד: 
סקרן אותנו מאוד את עולם המוזיקה , אז עדיין יש מסקרן אותנו לקבל תשובות על כמה שאלות :
1-	מה הם ההיבטים של המוזיקה שהכי משפיעים על המיקום ?
2-	מהי התכונה של האודיו שהכי פופלרית ? (שהיא משומשת כמעט בכל סוג מוזיקה )
